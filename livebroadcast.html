<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JPV TV — Watch & Listen</title>
  <meta name="description" content="JPV TV — HLS video + radio embed. Professional responsive player." />
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.0/dist/hls.min.js"></script>

  <style>
    /* Reset + safety */
    html,body{height:100%;margin:0;padding:0;overflow-x:hidden;-webkit-font-smoothing:antialiased}
    *,*:before,*:after{box-sizing:border-box}

    /* Background animated gradient */
    body{
      font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:linear-gradient(120deg,#0b1020,#12121a 40%, #0f1724 100%);
      color:#fff;
      min-height:100%;
      --accent:#ff7a00;
    }
    /* subtle animated accent overlay */
    body::before{
      content:"";
      position:fixed;inset:0;
      background:linear-gradient(60deg, rgba(255,122,0,0.06), rgba(255,200,120,0.03));
      pointer-events:none;
      mix-blend-mode:screen;
    }

    /* Top header */
    header{
      position:sticky;top:0;z-index:40;
      display:flex;align-items:center;justify-content:space-between;
      gap:12px;padding:10px 16px;background:rgba(6,8,15,0.5);
      border-bottom:1px solid rgba(255,255,255,0.03);
      backdrop-filter: blur(6px);
    }
    .logo-row{display:flex;align-items:center;gap:12px}
    .logo-row img{height:40px;width:auto;border-radius:8px;display:block}
    .title{font-weight:700;font-size:18px;color:#fff;letter-spacing:0.2px}
    .live-badge{
      background:#ff2d2d;color:#fff;padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;
      box-shadow:0 6px 20px rgba(255,45,45,0.18),0 0 8px rgba(255,45,45,0.12);
      animation:livePulse 1.6s infinite ease-in-out;
    }
    @keyframes livePulse{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}

    /* Center layout */
    main{width:100%;max-width:1000px;margin:20px auto;padding:0 16px 40px;display:flex;flex-direction:column;gap:16px}

    /* tab controls */
    .tabs{display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:6px}
    .tab-btn{
      background:transparent;border:1px solid rgba(255,255,255,0.06);color:rgba(255,255,255,0.9);
      padding:10px 16px;border-radius:999px;cursor:pointer;font-weight:600;backdrop-filter:blur(4px)
    }
    .tab-btn.active{background:linear-gradient(90deg,var(--accent),#ffb36b);color:#081018;border:none;box-shadow:0 8px 30px rgba(255,122,0,0.12)}

    /* media card */
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border-radius:14px;padding:10px;border:1px solid rgba(255,255,255,0.04);
      box-shadow: 0 12px 30px rgba(2,6,23,0.6);
      overflow:hidden;position:relative;
    }

    /* video */
    .player-wrap{width:100%;display:flex;flex-direction:column;gap:8px}
    video{width:100%;height:auto;max-height:66vh;border-radius:10px;background:#000;display:block}
    .controls-row{display:flex;align-items:center;gap:8px;justify-content:space-between;margin-top:6px}
    .small{font-size:13px;color:rgba(255,255,255,0.75)}

    /* unmute overlay */
    .unmute-overlay{
      position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
      z-index:30;padding:14px 22px;border-radius:999px;background:linear-gradient(90deg,var(--accent),#ffb36b);
      color:#081018;font-weight:700;box-shadow:0 12px 40px rgba(255,122,0,0.12);cursor:pointer;
      display:flex;gap:10px;align-items:center;backdrop-filter: blur(6px)
    }

    /* radio iframe container */
    .radio-wrap{padding:12px;border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.03)}
    .radio-iframe{width:100%;min-height:150px;border:0;border-radius:10px;display:block;overflow:hidden}

    /* visualizer fallback (if wanted later) */
    .visualizer{height:64px;display:flex;align-items:flex-end;gap:6px;padding:8px;border-radius:8px}
    .bar{flex:0 0 6px;background:linear-gradient(180deg,var(--accent),#ffcf8e);border-radius:4px;height:8px;transition:height .12s linear}

    /* backup button */
    .backup-btn{margin:12px auto 0;padding:10px 18px;border-radius:999px;border:none;background:linear-gradient(90deg,var(--accent),#ffb36b);color:#081018;font-weight:700;cursor:pointer;display:block}

    /* popup (glass) */
    .popup{
      position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:70;
      background:rgba(255,255,255,0.06);backdrop-filter:blur(10px);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);
      box-shadow:0 18px 60px rgba(2,6,23,0.7);display:none;max-width:92%;width:420px;text-align:center;
    }
    .popup img{width:100%;height:auto;border-radius:8px;border:2px solid rgba(255,255,255,0.03)}
    .popup .close{margin-top:10px;padding:8px 14px;border-radius:999px;border:none;background:var(--accent);color:#081018;font-weight:700;cursor:pointer}

    /* responsive tweaks */
    @media (max-width:720px){
      .title{font-size:16px}
      main{padding:0 12px 32px}
      header img{height:34px}
      .unmute-overlay{padding:12px 18px;font-size:15px}
      .popup{width:92%}
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-row">
      <img src="https://i.ibb.co/Z6Mf2dBF/Untitled-design.jpg" alt="JPV TV Logo">
      <div>
        <div class="title">JPV TV</div>
        <div class="small" style="opacity:.6">Jesse Penny & Vonn Network</div>
      </div>
    </div>

    <div style="display:flex;align-items:center;gap:12px">
      <div class="live-badge">LIVE</div>
    </div>
  </header>

  <main>
    <!-- tabs -->
    <div class="tabs" role="tablist" aria-label="Media tabs">
      <button id="tabWatch" class="tab-btn active" role="tab" aria-selected="true">Watch</button>
      <button id="tabListen" class="tab-btn" role="tab" aria-selected="false">Listen</button>
    </div>

    <!-- media card: video -->
    <div id="watchCard" class="card player-wrap" aria-hidden="false">
      <div class="player-wrap card" style="position:relative;padding:12px;">
        <video id="video" playsinline controls muted></video>
        <div id="unmute" class="unmute-overlay" style="display:flex">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 10v4h4l5 5V5L7 10H3z" fill="#081018"/></svg>
          <span>Tap to Unmute</span>
        </div>
      </div>

      <div class="controls-row" style="padding:8px 12px;align-items:center">
        <div class="small">If stream fails, use the backup button below.</div>
        <button id="backupWatch" class="backup-btn small" style="margin:0">Backup Player</button>
      </div>
    </div>

    <!-- media card: radio (hidden by default) -->
    <div id="listenCard" class="card" style="display:none">
      <div class="radio-wrap">
        <!-- lazy-loaded iframe: src set when Listen tab selected -->
        <iframe id="radioIframe" class="radio-iframe" src="" allowtransparency="true" scrolling="no" loading="lazy"></iframe>
      </div>

      <div style="padding:10px 12px;display:flex;flex-direction:column;gap:8px;align-items:center">
        <div class="small">If the player doesn't load, open Backup Player.</div>
        <button id="backupRadio" class="backup-btn">Backup Radio</button>
      </div>
    </div>

    <!-- popup -->
    <div id="popup" class="popup" role="dialog" aria-modal="true">
      <img src="https://jpvradio.online/if%20the%20stream%20dont%20load%20kindly%20refresh%20the%20page%20or%20click%20the%20backup%20player.png" alt="Stream help">
      <button class="close" id="closePopup">Close</button>
    </div>
  </main>

  <script>
    // URLs
    const VIDEO_URL = "https://live20.bozztv.com/akamaissh101/ssh101/jpvradio/playlist.m3u8";
    const RADIO_IFRAME_URL = "https://usa1.bntworxtv.com/public/jesse_penny_and_vonn_radio_and_television_network_inc./embed";

    // Elements
    const tabWatch = document.getElementById('tabWatch');
    const tabListen = document.getElementById('tabListen');
    const watchCard = document.getElementById('watchCard');
    const listenCard = document.getElementById('listenCard');
    const video = document.getElementById('video');
    const unmute = document.getElementById('unmute');
    const radioIframe = document.getElementById('radioIframe');
    const backupWatch = document.getElementById('backupWatch');
    const backupRadio = document.getElementById('backupRadio');
    const popup = document.getElementById('popup');
    const closePopup = document.getElementById('closePopup');

    // HLS load (attach but do not autoplay in background)
    function initHls() {
      if (!video) return;
      if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = VIDEO_URL;
      } else if (window.Hls && Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(VIDEO_URL);
        hls.attachMedia(video);
      } else {
        console.warn('HLS not supported in this browser.');
      }
    }

    // Initialize watch view with 5s countdown and muted autoplay
    let countdown = 5;
    function startCountdownAndPlay() {
      // Show small countdown in title area (accessible UX)
      const origTitle = document.title;
      const interval = setInterval(()=>{
        if (countdown > 0) {
          document.title = `Starting in ${countdown}s — JPV TV`;
          countdown--;
        } else {
          clearInterval(interval);
          document.title = origTitle;
          // try to play (muted)
          video.muted = true;
          video.play().catch(()=>{ /* autoplay blocked often on mobile */});
        }
      }, 1000);
    }

    // Tab switching
    function activateWatch() {
      tabWatch.classList.add('active'); tabListen.classList.remove('active');
      tabWatch.setAttribute('aria-selected','true'); tabListen.setAttribute('aria-selected','false');
      watchCard.style.display = ''; listenCard.style.display = 'none';
      // set backup button
      backupWatch.style.display='inline-block';
      backupRadio.style.display='none';
      backupWatch.onclick = ()=> window.open(VIDEO_URL, '_blank');
      // ensure HLS loaded
      initHls();
    }
    function activateListen() {
      tabListen.classList.add('active'); tabWatch.classList.remove('active');
      tabListen.setAttribute('aria-selected','true'); tabWatch.setAttribute('aria-selected','false');
      listenCard.style.display = ''; watchCard.style.display = 'none';
      // lazy-load iframe src to reduce initial load
      if (!radioIframe.src) radioIframe.src = RADIO_IFRAME_URL;
      // backup button
      backupRadio.style.display='inline-block';
      backupWatch.style.display='none';
      backupRadio.onclick = ()=> window.open(RADIO_IFRAME_URL, '_blank');
      // some embed players auto-play; we try to focus
      radioIframe.focus();
    }

    tabWatch.addEventListener('click', ()=> {
      activateWatch();
    });
    tabListen.addEventListener('click', ()=> {
      activateListen();
    });

    // unmute overlay
    unmute.addEventListener('click', ()=> {
      video.muted = false;
      unmute.style.display = 'none';
      // in many browsers user interaction allows play with sound now
      video.play().catch(()=>{});
    });

    // popup logic: every 3 clicks or on right-click
    let clickCount = 0;
    document.addEventListener('click', (e)=>{
      // avoid counting clicks on UI elements like the popup close or tabs to reduce annoyance
      const excluded = e.target.closest('.popup') || e.target.closest('.tab-btn') || e.target.closest('.unmute-overlay') || e.target.closest('button');
      if (!excluded) {
        clickCount++;
        if (clickCount % 3 === 0) showPopup();
      }
    });
    document.addEventListener('contextmenu', (e)=>{
      e.preventDefault();
      showPopup();
    });
    function showPopup(){ popup.style.display = 'block'; }
    closePopup.addEventListener('click', ()=> popup.style.display = 'none');

    // init
    initHls();
    startCountdownAndPlay();
    // default active
    activateWatch();

    // Accessibility: hide popup with Escape
    window.addEventListener('keydown', (e)=> { if (e.key==='Escape') popup.style.display='none'; });

    // Prevent horizontal scroll issues - ensure body width clamp
    document.documentElement.style.maxWidth = '100%';
    document.body.style.maxWidth = '100%';
  </script>
</body>
</html>
