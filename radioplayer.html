<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JPV RADIO PLAYER</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: url('https://jpvradio.online/jpv%20radio%20background%20visualizer.gif') no-repeat center center fixed;
      background-size: cover;
      color: white;
      text-align: center;
    }
    .logo {
      width: 180px;
      margin-top: 20px;
    }
    .player-container {
      margin-top: 30px;
      padding: 20px;
      background-color: rgba(0,0,0,0.6);
      border-radius: 15px;
      display: inline-block;
    }
    audio {
      width: 100%;
      max-width: 300px;
      margin: 20px 0;
    }
    .now-playing {
      font-size: 1.2rem;
      font-weight: bold;
      color: #FFA500;
      margin-bottom: 10px;
    }
    .listeners {
      font-size: 0.9rem;
      color: #ddd;
    }
    @media (max-width: 600px) {
      .logo {
        width: 130px;
      }
      .now-playing {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <img src="https://jpvradio.online/jesse%20penny%20and%20vonn%20logo.jpg" alt="JPV Logo" class="logo" />

  <div class="player-container">
    <audio controls>
      <source src="https://listen2.streamaudio.co/stream/8012" type="audio/mpeg" />
      Your browser does not support the audio element.
    </audio>

    <div class="now-playing" id="nowPlaying">Loading...</div>
    <div class="listeners" id="listenerCount">Listeners: --</div>
  </div>

  <script>
    async function fetchNowPlaying() {
      try {
        const response = await fetch("https://listen2.streamaudio.co/json/stream/8012");
        const data = await response.json();

        let title = data.nowplaying || "Unknown";
        let listeners = data.connections || 0;

        // Clean the title with advanced filters
        title = title
          .replace(/(\.mp3|\.mp4|\.wav|\.mkv|\.flac|\.avi|\.mov)/gi, "")
          .replace(/\b(track ?\d{1,3}|adm ?\d{1,3}|lyrics?|stereo|copy|youtube|with|music|high quality|hq|hd|official( music)?( video)?|music video|visualizer|feat\.?|featuring|cover|remastered|audio|mv|version|video)\b/gi, "")
          .replace(/\d{1,4}/g, "")
          .replace(/[-_]+/g, " ")
          .replace(/\s+/g, " ")
          .trim();

        document.getElementById("nowPlaying").innerText = "Now Playing: " + title;
        document.getElementById("listenerCount").innerText = "Listeners: " + listeners;
      } catch (error) {
        document.getElementById("nowPlaying").innerText = "Now Playing: Unavailable";
        document.getElementById("listenerCount").innerText = "Listeners: --";
      }
    }

    fetchNowPlaying();
    setInterval(fetchNowPlaying, 10000); // refresh every 10s
  </script>
</body>
</html>
